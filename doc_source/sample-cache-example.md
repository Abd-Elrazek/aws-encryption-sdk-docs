# Data Key Caching Example<a name="sample-cache-example"></a>

This example uses data key caching with a LocalCryptoMaterialsCache to speed up an application in which data generated by multiple devices is encrypted and stored in different regions\.

In this scenario, multiple data producers generate data, encrypt it, and write to a [Kinesis stream](https://aws.amazon.com/kinesis/streams/) in each region\. [AWS Lambda](https://aws.amazon.com/lambda/) functions \(consumers\) decrypt the streams and write plaintext data to a DynamoDB table in the region\. Data producers and consumers use the AWS Encryption SDK and a KMS master key provider\. To reduce calls to KMS, each producer and consumer has their own LocalCryptoMaterialsCache\.

You can find the source code for these examples in Java and Python\. The sample also includes a AWS CloudFormation template that defines the resources for the samples\.

![\[This diagram shows how data producers and consumers use the AWS KMS, Amazon Kinesis Streams and
        Amazon DynamoDB.\]](http://docs.aws.amazon.com/encryption-sdk/latest/developer-guide/images/simplecache-example.png)

## LocalCryptoMaterialsCache Results<a name="caching-example-impact"></a>

The following table shows that LocalCryptoMaterialsCache reduces the total calls to KMS \(per second per region\) in this example to 1% of its original value\.


**Producer requests**  
[\[See the AWS documentation website for more details\]](http://docs.aws.amazon.com/encryption-sdk/latest/developer-guide/sample-cache-example.html)


**Consumer requests**  
[\[See the AWS documentation website for more details\]](http://docs.aws.amazon.com/encryption-sdk/latest/developer-guide/sample-cache-example.html)